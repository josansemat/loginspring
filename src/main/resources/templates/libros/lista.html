<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Biblioteca - Listado de Libros</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>
    <div class="container">
        <header>
            <h1>Biblioteca Virtual</h1>
            <div class="user-info">
                <span th:text="'Usuario: ' + ${nombreUsuario}"></span>
                <a th:href="@{/logout}" class="btn btn-small">Cerrar Sesión</a>
            </div>
        </header>
        
        <div th:if="${mensajes}" class="mensajes">
            <div th:each="mensaje : ${mensajes}" class="mensaje">
                <p th:text="${mensaje}"></p>
            </div>
        </div>
        
        <div class="actions">
            <a th:href="@{/libros/crear}" class="btn">Añadir Nuevo Libro</a>
            
            <form th:action="@{/libros/buscar}" method="get" class="search-form">
                <input type="text" name="patron" th:value="${patron}" placeholder="Buscar por título, autor o descripción..." required>
                <button type="submit" class="btn btn-search">Buscar</button>
            </form>
        </div>
        
        <div th:if="${patron}" class="search-results">
            <h2 th:text="'Resultados para: ' + ${patron}"></h2>
            <a th:href="@{/libros}" class="btn btn-small">Ver todos</a>
        </div>
        
        <div class="libros-container">
            <div th:if="${#lists.isEmpty(libros)}" class="no-results">
                <p>No se encontraron libros</p>
            </div>
            
            <table th:if="${not #lists.isEmpty(libros)}">
                <thead>
                    <tr>
                        <th>Título</th>
                        <th>Autor</th>
                        <th>Año</th>
                        <th>Género</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="libro : ${libros}">
                        <td th:text="${libro.titulo}"></td>
                        <td th:text="${libro.autor}"></td>
                        <td th:text="${libro.anioPublicacion}"></td>
                        <td th:text="${libro.genero ?: 'No especificado'}"></td>
                        <td class="actions">
                            <a th:href="@{/libros/detalles/{id}(id=${libro.id})}" class="btn btn-small">Ver</a>
                            <a th:href="@{/libros/editar/{id}(id=${libro.id})}" class="btn btn-small">Editar</a>
                            <a th:href="@{/libros/eliminar/{id}(id=${libro.id})}" class="btn btn-small btn-danger" 
                               onclick="return confirm('¿Estás seguro de eliminar este libro?')">Eliminar</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    
    <script th:src="@{/js/scripts.js}"></script>
</body>
</html> 